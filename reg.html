<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GODX Guild Application</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="body-REG">
  <h1 class="headline">ğ—šğ—¨ğ—œğ—Ÿğ—— ğ—¥ğ—˜ğ—¤ğ—¨ğ—œğ—¥ğ—˜ğ— ğ—˜ğ—¡ğ—§ â€“ ğ—šğ—¢ğ——X ğ—˜ğ—¦ğ—£ğ—¢ğ—¥ğ—§ğ—¦</h1>

  <form id="GuildFORM" method="POST" action="/apply" enctype="multipart/form-data">
    <table border="1">
      <tr>
        <td><label for="name">Name</label></td>
        <td><input id="name" type="text" name="name" required></td>
      </tr>

      <tr>
        <td><label for="discordId">Discord User ID</label></td>
        <td>
          <input id="discordId" type="text" name="discordId" pattern="\d{17,20}" required>
          <small>Enter your numeric Discord ID (17â€“20 digits)</small>
        </td>
      </tr>

      <tr>
        <td><label for="age">Age</label></td>
        <td><input id="age" type="number" name="age" min="10" required></td>
      </tr>

      <tr>
        <td><label for="experience">Experience</label></td>
        <td><textarea id="experience" name="experience" rows="3"></textarea></td>
      </tr>

      <tr>
        <td>Role</td>
        <td>
          <label><input type="checkbox" name="roles" value="Rusher"> Rusher</label><br>
          <label><input type="checkbox" name="roles" value="Sniper"> Sniper</label><br>
          <label><input type="checkbox" name="roles" value="All Rounder"> All Rounder</label>
        </td>
      </tr>

      <tr>
        <td>Device</td>
        <td>
          <label><input type="checkbox" name="devices" value="Mobile"> Mobile</label><br>
          <label><input type="checkbox" name="devices" value="PC"> PC</label>
        </td>
      </tr>

      <tr>
        <td><label for="discord_pic">Profile Image</label></td>
        <td><input id="discord_pic" type="file" name="discord_pic" accept="image/png, image/jpeg"></td>
      </tr>
    </table>

    <br>
    <button type="submit">Submit</button>
  </form>

<script>
    document.getElementById('applicationForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        // Get form data
        const formData = new FormData(this);
        const data = {
            name: formData.get('name'),
            discordId: formData.get('discordId'),
            age: formData.get('age'),
            experience: formData.get('experience'),
            role: formData.getAll('role'), // Collects all checked roles
            device: formData.getAll('device') // Collects all checked devices
        };

        try {
            // Updated to your Railway Production URL
            const response = await fetch('https://godx-guild-application-production.up.railway.app/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                alert('Application submitted successfully!');
                window.location.href = 'gr.html';
            } else {
                alert('Submission failed. Check backend logs.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('Server connection failed. Make sure your Railway server is awake.');
        }
    });
</script>
</html>